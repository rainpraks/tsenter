<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <title>Furnituuri sobivus kalkulaator</title>
</head>
<body>
    <div class="content-container">
        <h1> Furnituuri sobivus kalkulaator</h1>
        <form id="myForm" action="/furnituur" method="POST">
            <section>
                    <h2>Sisesta parameetrid:</h2> 
            </section>
            <table id="furnituurid">
                    <tr>
                        <td>
                            <input type="radio" id="kandevKulg" name="k1" value="Kandev Kulg" checked="checked">
                            <label for="kandevKulg" class="radio-button-label"></label>
                        </td>
                        <td>
                            <input type="radio" id="lagiPeal" name="k1" value="Lagi Peal" >
                            <label for="lagiPeal" class="radio-button-label"></label>
                        </td>
                        <td>
                            <input type="radio" id="eerung" name="k1" value="Eerung">
                            <label for="eerung" class="radio-button-label"></label>
                        </td>
                        <td>
                            <input type="radio" id="vaheriiul" name="k1" value="Vaheriiul">
                            <label for="vaheriiul" class="radio-button-label"></label>
                        </td>
                        <td>
                            <input type="radio" id="vahesein" name="k1" value="Vahesein">
                            <label for="vahesein" class="radio-button-label"></label>
                        </td>
                    </tr>
            </table>
            <table>
                <tr>
                    <th>Konstruktsiooni valiku kriteeriumid</th>
                </tr>
                <tr>
                    <td>Ühendus k2</td>
                    <td><input type="radio" name="k2" value="avatav">avatav</td>
                    <td><input type="radio" name="k2" value="mitteavatav" checked="checked"> mitteavatav</td>
                </tr>
                <tr>
                    <td>Ühendus k3</td>
                    <td><input type="radio" name="k3" value="Liimiga" checked="checked">liimiga </td>
                    <td><input type="radio" name="k3" value="Liimita" > liimita</td>
                </tr>
                <tr>
                    <td>MONT/FP</td>
                    <td><input type="radio" name="mont/fp" value="Monteeritud" checked="checked">monteeritud</td>
                    <td><input type="radio" name="mont/fp" value="Flatpack"> flatpack</td>
                </tr>
                <tr>
                    <td>Nähtavus 1</td>
                    <td><input type="radio" name="nahtavus1" value="Nahtav" checked="checked">nähtav</td>
                    <td><input type="radio" name="nahtavus1" value="mittenahtav"> mittenähtav</td>
                </tr>
                <tr>
                    <td>Nähtavus 2</td>
                    <td><input type="radio" name="nahtavus2" value="Valjast Nahtav" checked="checked">väljast nähtav</td>
                    <td><input type="radio" name="nahtavus2" value="Seest Nahtav"> seest nähtav</td>
                </tr>
                <tr>
                    <td>Materjal</td>
                    <td><select>
                            <option value="taispuit">täispuit</option>
                            <option value="vineer">vineer</option>
                            <option value="MDF">MDF</option>
                            <option value="PLP">PLP</option>
                            <option value="kergplaat">kergplaat</option>
                <tr>
                    <td>Paksus</td>
                    <td colspan="5"><input type="number" name="thickness" min="10" max="34" value="paksus"></td>
                </tr>
                <tr>
                    <td>Koostu sügavus</td>
                    <td colspan="6"><input type="number" name="thickness" min="40" max="700" value="sugavus"></td>
                </tr>
                <tr>
                    <th>Tehnoloogia valiku kriteeriumid</th>
                </tr>
                <tr>
                    <td>Serva puurimise võimekus</td>
                    <td><input type="radio" name="servapuurimisevoimekus" value="ServaPuurJAH" checked="checked">jah</td>
                    <td><input type="radio" name="servapuurimisevoimekus" value="ServaPuurEI">ei </td>
                </tr>
                <tr>
                    <td>CNC</td>
                    <td><input type="radio" name="CNC" value="CNCjah" checked="checked">jah</td>
                    <td><input type="radio" name="CNC" value="CNCei"> ei</td>
                </tr>
                <tr>
                    <td>Lamello masin</td>
                    <td><input type="radio" name="Lamello" value="LamelloJAH" checked="checked">jah</td>
                    <td><input type="radio" name="Lamello" value="LamelloEI"> ei</td>
                </tr>
                <tr>
                    <td>Domino masin</td>
                    <td><input type="radio" name="Domino" value="dominoJAH" checked="checked">jah</td>
                    <td><input type="radio" name="Domino" value="dominoEI"> ei</td>
                </tr>
                <tr>
                    <td>OVVO masin</td>
                    <td><input type="radio" name="OVVO" value="ovvoJah" checked="checked">jah</td>
                    <td><input type="radio" name="OVVO" value="ovvoEI"> ei</td>
                </tr>
                <div id="messageAvatav" style="display: none; color: red;"></div>
                <div id="messageMittenähtav" style="display: none; color: red;"></div>
        </form>
        </table>
            <section>
                <h2>Tulemused:</h2> 
            </section>
        <table class="table">
                <thead>
                    <tr>
                        <th>Furnituur</th>
                        <th>Konstruktsiooni sobivus</th>
                        <th>Tehnoloogia sobivus</th>
                    </tr>
                </thead>
            <tbody></tbody>
        </table>
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    function toggleLiimiga(enable) {
                        document.querySelector('input[name="k3"][value="Liimiga"]').disabled = !enable;
                        if (!enable) {
                            document.querySelector('input[name="k3"][value="Liimita"]').checked = true;
                        }
                    }

                    function toggleNähtavus(enable) {
                        document.querySelector('input[name="nahtavus2"][value="Valjast Nahtav"]').disabled = !enable;
                        document.querySelector('input[name="nahtavus2"][value="Seest Nahtav"]').disabled = !enable;
                        if (!enable) {
                            document.querySelector('input[name="nahtavus2"][value="Valjast Nahtav"]').checked = false;
                            document.querySelector('input[name="nahtavus2"][value="Seest Nahtav"]').checked = false;
                        }
                    }

                    function showMessage(elementId, show, message) {
                        var messageElement = document.getElementById(elementId);
                        if (show) {
                            messageElement.style.display = 'block';
                            messageElement.textContent = message;
                        } else {
                            messageElement.style.display = 'none';
                        }
                    }

                    document.querySelectorAll('input[name="k2"]').forEach(function (radio) {
                        radio.addEventListener('change', function (e) {
                            if (e.target.value === 'avatav') {
                                toggleLiimiga(false);
                                showMessage('messageAvatav', true, "Ei saa valida liimiga kui on valitud avatav furnituur");
                            } else {
                                toggleLiimiga(true);
                                showMessage('messageAvatav', false);
                            }
                        });
                    });

                    document.querySelectorAll('input[name="nahtavus1"]').forEach(function (radio) {
                        radio.addEventListener('change', function (e) {
                            if (e.target.value === 'mittenahtav') {
                                toggleNähtavus(false);
                                showMessage('messageMittenähtav', true, "Ei saa valida väljast nähtav või seest nähtav kui on valitud mittenähtav furnituur.");
                            } else {
                                toggleNähtavus(true);
                                showMessage('messageMittenähtav', false);
                            }
                        });
                    });
                });
            </script>
            <script>
                async function loadIntoTable(url, table) {
                    const tableBody = table.querySelector("tbody");

                    async function updateTable() {
                        const formData = new FormData(document.getElementById('myForm'));
                        const response = await fetch(url, {
                            method: 'POST',
                            body: formData
                        });
                        const data = await response.json();
                        tableBody.innerHTML = "";  // Clear existing table data

                        // Iterate through each item in the data and add it to the table
                        data.forEach(item => {
                            const row = tableBody.insertRow();
                            row.innerHTML = `<td>${item.Name}</td><td>${item.ConScore}</td><td>${item.TechScore}</td>`;
                        });
                    }

                    // Attach event listener to radio buttons to update the table on change
                    document.querySelectorAll('input[type="radio"]').forEach(radio => {
                        radio.addEventListener('change', updateTable);
                    });

                    // Initial table population (optional)
                    updateTable();
                }

                // Load data into the table when a radio button is clicked
                // Note: Adjust the URL as per your server configuration
                loadIntoTable("/furnituur", document.querySelector(".table"));

            </script>
        </div>
    </body>
</html>